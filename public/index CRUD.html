<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CRUD Interface</title>
</head>
<body>
  <h2>Item Manager</h2>

  <select id="operation">
    <option value="create">Create</option>
    <option value="read">Read</option>
    <option value="update">Update</option>
    <option value="delete">Delete</option>
  </select>

  <div id="form-area">
    <!-- Dynamic input fields will appear here -->
  </div>

  <button id="submitBtn">Confirm</button>

  <pre id="output"></pre>

  <script>
    const operationSelect = document.getElementById('operation');
    const formArea = document.getElementById('form-area');
    const submitBtn = document.getElementById('submitBtn');
    const output = document.getElementById('output');

    function updateFormFields(op) {
      let html = '';
      switch (op) {
        case 'create':
          html = `
            <input type="text" id="name" placeholder="Name"><br>
            <input type="text" id="description" placeholder="Description"><br>
          `;
          break;
        case 'read':
          html = ''; // No input needed
          break;
        case 'update':
          html = `
            <input type="text" id="id" placeholder="ID"><br>
            <input type="text" id="name" placeholder="New Name"><br>
            <input type="text" id="description" placeholder="New Description"><br>
          `;
          break;
        case 'delete':
          html = `
            <input type="text" id="id" placeholder="ID"><br>
          `;
          break;
      }
      formArea.innerHTML = html;
    }

    operationSelect.addEventListener('change', (e) => {
      updateFormFields(e.target.value);
    });

    submitBtn.addEventListener('click', async () => {
      const op = operationSelect.value;
      const id = document.getElementById('id')?.value;
      const name = document.getElementById('name')?.value;
      const description = document.getElementById('description')?.value;

      let res;
      try {
        if (op === 'create') {
          res = await fetch('/api/items', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, description }),
          });
        } else if (op === 'read') {
          res = await fetch('/api/items');
        } else if (op === 'update') {
          res = await fetch(`/api/items/${id}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, description }),
          });
        } else if (op === 'delete') {
          res = await fetch(`/api/items/${id}`, { method: 'DELETE' });
        }

        const data = await res.json();
        output.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        output.textContent = 'Error: ' + err.message;
      }
    });

    // Set initial form state
    updateFormFields(operationSelect.value);
  </script>
</body>
</html>
